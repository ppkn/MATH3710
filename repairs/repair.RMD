---
title: "Repairs"
author: "Cody Frisby"
date: "December 15, 2015"
output: 
  html_document: 
    keep_md: yes
---

```{r, echo = FALSE, message = FALSE}
#to check for required packages before running code.
if (!require(psych))
        {install.packages("psych")
        library(psych, warn.conflicts = FALSE)
        }
```

Let's get started with R.  This first data set is small so we have the data loaded into two variables: minutes and units.  We then put them together with the cbind function and store the result in a new variable called repair.

```{r}
units <- c(1,2,3,4,4,5,6,6,7,8,9,9,10,10,3)
minutes <- c(23,29,49,64,74,87,96,97,109,119,149,145,154,166, NA)
repair <- as.data.frame(cbind(units, minutes))
head(repair)
describe(repair)
```

Above is a summary of the data table "repair".  Below is a table of the correlation coefficients.  

```{r}
cor(repair, method = "pearson", use = "complete.obs")
```

Now let's plot the data look at the variable minutes being modeled as a function of units.

```{r, echo=FALSE}
plot(minutes ~ units, data=repair, bg = "lightblue", 
     col = "black", cex = 1.5, pch = 21)
#fit the least squares line to the plot.
abline(lm(minutes ~ units, data = repair), lwd = 1, col = "red")
m <- lm(minutes ~ units, data = repair)
#to display the R^2 value on the graph
legend("topleft", bty = "n", legend = paste("R^2 =", format(summary(m)$adj.r.squared, digits = 4)))
```

Below is a plot of the residuals vs fitted, Normal Quantile, Scale-Location, Residuals vs Leverage.

```{r}
par(mfrow=c(2,2)) #setup your window to fit the next plots
plot(m)
```
